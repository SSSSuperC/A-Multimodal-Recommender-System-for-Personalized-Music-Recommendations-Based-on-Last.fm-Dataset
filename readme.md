# Multimodal Recommender System for Personalized Music Recommendations

## Overview
This project focuses on building a multimodal recommender system to generate personalized music recommendations using data from Last.fm. By integrating different features and modalities, such as user behavior, tags, and artist information, the recommender aims to provide more accurate and personalized recommendations for users.

## Dataset
The dataset used for this project is derived from Last.fm's online music system and is well-suited for research on recommender systems. It was introduced at the HetRec 2011 conference and includes the following:

1. **Artists Dataset**:
   - Rows: 17632, Columns: 4
   - Columns: `id`, `name`, `url`, `pictureURL`
   - Missing Values: `pictureURL` has 444 missing values

2. **Tags Dataset**:
   - Rows: 11946, Columns: 2
   - Columns: `tagID`, `tagValue`

3. **User-Artists Dataset**:
   - Rows: 92834, Columns: 3
   - Columns: `userID`, `artistID`, `weight`
   - Nature: Highly imbalanced interaction weights

4. **User-Tagged Artists Timestamps Dataset**:
   - Rows: 186479, Columns: 4
   - Columns: `userID`, `artistID`, `tagID`, `timestamp`

5. **User-Friends Dataset**:
   - Rows: 25434, Columns: 2
   - Columns: `userID`, `friendID`

## Data Preprocessing
To prepare the data for modeling, various preprocessing steps were applied:

- **Artists Dataset**: Missing values in `pictureURL` were filled. Processed data was saved as `processed_artists.csv`.
- **Tags Dataset**: Tag values were cleaned (lowercased, whitespace/special characters removed), resulting in `processed_tags.csv`.
- **User-Artists Dataset**: Log normalization applied on the interaction weights, resulting in `processed_user_features.csv` and `processed_artist_features.csv`.
- **User-Tagged Artists Timestamps Dataset**: Minimal usage tags were removed. Features were aggregated into matrices (`processed_user_tag_matrix.csv` and `processed_artist_tag_matrix.csv`).
- **User-Friends Dataset**: Calculated common tag preferences among friends. Normalized data was saved as `normalized_user_friend_features.csv`.
- **Feature Aggregation**: Final interaction dataset was created by combining `user_features`, `artist_features`, `user_tag_matrix`, and `artist_tag_matrix`, saved as `final_interaction_data.csv`.

## Modeling Approach
The project used two types of models:

1. **XGBoost Model**:
   - Trained using the complete feature set.
   - Tuned with early stopping based on validation metrics.

2. **Transformer Recommender Model**:
   - Utilized PyTorch to train a simple MLP with only selected behavioral features.

## Model Fusion
- The outputs of both models were combined using a weighted average approach to generate final recommendations.
- Fusion allowed for balancing between the XGBoost and MLP predictions for improved personalization.

## Performance Evaluation
- Metrics used for evaluation included **Precision** and **Recall**.
- Precision and Recall were calculated based on the overlap between actual interactions and recommendations generated by each model.
- Visualization of the distribution of recommended items across users helped in understanding model behavior.

## Visualization
Throughout the project, the training process of each model was monitored with loss curves and accuracy evaluation. This allowed for optimization of model parameters and adjustments during training.

## Output
The final output of the project included recommendations for each user, where the `artistID` predicted by the models was mapped back to their names from the original artists' dataset.

- The final recommendations were saved in `final_user_artist_recommendations_with_names.csv`.
- The dataset included `userID` and `predicted_artist_name` columns, providing readable and user-friendly recommendation results.

## Requirements
- Python 3.8+
- PyTorch
- XGBoost
- Pandas, Numpy, Scikit-Learn

## Future Work
- Implementing more sophisticated fusion strategies, such as meta-learners.
- Incorporating more modalities like user demographics for further personalization.
- Exploring sequence-based models for more temporal-aware recommendations.

## Conclusion
This project successfully demonstrates a multimodal recommendation system by integrating behavioral, social, and content features, ultimately generating personalized music recommendations. The combination of XGBoost and Transformer models achieved a balanced prediction, benefiting from both shallow and deep model capabilities.